#!/bin/shell

if ! cmd_exists docker; then
  :
else
  : "set peco functions" && {
    if cmd_exists peco; then
      function peco-find-docker-ps() {
        selected_id=$(docker ps | tail -n +2 | peco --prompt "[find process]" --layout=bottom-up | cut -d" " -f1)
        BUFFER="${BUFFER}$(echo $selected_id | tr '\n' ' ')"
        CURSOR=$#BUFFER
      }
      zle -N peco-find-docker-ps
      bindkey -r "^d" # どうやらlogoutがbindされているので、無効化しておく
      bindkey "^d^p" peco-find-docker-ps
    fi
  }
fi
